<!DOCTYPE html>
<html>
  <head>
    <title>Trial Experiment</title>


    <meta charset="utf-8">
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>

    <link id="sudocss" rel="stylesheet" media="all" type="text/css" href="sudoku.css">
    <link id="x2" rel="stylesheet" media="all" type="text/css" href="jsPsych/css/2x2.css">
    <link id="x3" rel="stylesheet" media="all" type="text/css" href="jsPsych/css/2x3.css">
    <link id="x4" rel="stylesheet" media="all" type="text/css" href="jsPsych/css/2x4.css">
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

    <script type="text/javascript" src="jsPsych/jspsych.js"></script>

    
    <script type="text/javascript" src="jsPsych/jspsych-plugin-sudoku.js"></script>
    <script type="text/javascript" src="sudoku.js"></script>
    <script type="text/javascript" src="timer.js"></script>
    
    <script type="text/javascript" src="jsPsych/plugins/jspsych-survey-likert.js"></script>
    <script type="text/javascript" src="jsPsych/plugins/jspsych-image-keyboard-response.js" ></script>
    <script type="text/javascript" src="jsPsych/plugins/jspsych-survey-multi-choice.js"></script>
    <script type="text/javascript" src="jsPsych/plugins/jspsych-call-function.js"></script>
    <script type="text/javascript" src="jsPsych/plugins/jspsych-instructions.js"></script>
    <script type="text/javascript" src="jsPsych/plugins/jspsych-html-keyboard-response.js"></script>
    <script type="text/javascript" src="jsPsych/plugins/jspsych-survey-text.js"></script>
    <link id="jscss" href="jsPsych/css/jspsych.css" rel="stylesheet" type="text/css">

    
  </head>
  <body>
  <script>

    var timeline = [];






/*    function checklength(e1) {
      if (e1.value.length != 6) {
        alert("Password must be exactly 6 characters");
      }
    }*/


/*    var password = {
      type: 'survey-text',
      questions: [{prompt: 'Please enter the password that you created earlier. This password should consist of: <br><br> - the first two letters of your last name;<br> - the last two letters of your first name;<br> - the last two digits of the year you were born; <br><br><br>',
               value: '', rows: 1, columns: 20}],
    };
    timeline.push(password);*/

 var welcome = {
      type: 'instructions',
      pages: ['Hello! <br> You are invited to participate in a research study that aims to develop a new psychological instrument. This instrument will be used in the future studies investigating the role of individual psychological characteristics in problem-solving skills. People that we invite to participate come from different backgrounds and are 18 years of age or older. <br> <br> Please take whatever time you need to decide whether or not you want to participate in the study. The decision to join, or not to join, is up to you.',
      '<b>WHAT IS INVOLED IN THE STUDY</b> <br> In this study, we will ask you to answer a few questions about yourself and complete several thinking tasks within a time limit. You do not need to have any prior experience with these tasks or any special knowledge. Before solving them, you will read detailed instructions explaining how to do these tasks. We estimate that the participation will take you 25 minutes in total. You can stop participating at any time. <br><br> <b>RISKS</b> <br> We believe that your participation in this study does not involve any physical or psychological risks. <br><br> <b>BENEFITS TO TAKING PART IN THE STUDY</b> <br> The study results will help develop a new instrument that will allow us to assess individual abilities to solve tasks within a given time limit. You might find it fun to solve the tasks; however, we cannot guarantee that you personally will experience any other benefits from participating in this study.',
      '<b>CONFIDENTIALITY</b> <br> All information collected during the study period will be kept strictly confidential. No publications or reports from this project will include identifying information on any participant. The data will be analyzed and presented at an aggregate level. There will be no record that links the data collected from you with any personal data from which you could be identified. Once anonymized, these data may be made available to researchers via accessible data repositories and possibly used for novel purposes. <br><br> <b>YOUR RIGHTS AS A RESEARCH PARTICIPANT</b> <br> Participation in this study is voluntary. You have the right not to participate at all or to leave the study at any time. Deciding not to participate or choosing to leave the study will not result in any penalty or loss of benefits to which you are entitled.',
      '<b>CONTACTS FOR QUESTIONS OR PROBLEMS</b> <br> If you have any questions or would like to receive additional information about the study, you may contact Olga Poluektova, Ph.D. Fellow at Bremen Graduate School of Social Sciences (BIGSSS) at opoluektova@bigsss-bremen.de. If you have any concerns about the study or your rights as a research participant, you may contact BIGSSS Ethics Committee at ethics@bigsss-bremen.de.'
      ],
      show_clickable_nav: true,
    }
    timeline.push(welcome);

    var multi_choice_block = {
        type: 'survey-multi-choice',
        questions: [{prompt: "By participating in this research study, you agree that:<br><br> (1) You have read and understood the information about the study, including the information about risks, benefits, confidentiality policy and your rights as a research participant; <br> (2) Your questions about your participation have been answered satisfactorily and you take part in this research study voluntarily; <br> (3) No personal data from which you can be identified will be made public; <br> (4) You are 18 years of age or older.",
        options: ["I agree to participate in this research study", "I disagree to participate in this research study"], 
        required: true}],
        show_clickable_nav: true,
        on_finish: function(data) {
          if (JSON.parse(data.responses).Q0 == "I disagree to participate in this research study") {
            jsPsych.endExperiment('We thank you for your participation and will be happy to answer any questions or provide additional comments about the study.');
          }
        }
    }
    timeline.push(multi_choice_block);


    var instructions = {
      type: 'instructions',
      pages: [

     "Thank you for agreeing to participate in the study! <br><br> Your participation will involve two types of activities. First, we will ask you to answer a few questions regarding the general representations that people hold about themselves and about your background. Second, you will complete several letter Sudoku puzzles and answer the questions regarding your experiences with these puzzles. <br> You do not need to have any knowledge or prior experience with Sudoku; we will provide detailed instructions that explain what Sudoku puzzles are and how to solve them.",

      "We value your time and effort and have tried to come up with the version of the study that is as short and as engaging as possible. <br> We would very much appreciate if you stayed focused and not get distracted while you participate. <br><br> We hope you will enjoy your participation!",

      "On the next screen, you will see a few statements that describe the way different people think about themselves. Please read these statements and for each indicate how much you agree with it. <br><br> There are no right or wrong answers. These statements reflect general perceptions, and the answer that comes to mind first is generally the best.",
      ],
      show_clickable_nav: true,
    }
    timeline.push(instructions);
    
    
    
    var scale = ["Strongly disagree", "Somewhat disagree", "Somewhat agree", "Strongly agree"];

    var gse1 = {
        type: 'survey-likert',
        questions: [{prompt: "I can always manage to solve difficult problems if I try hard enough.", labels: scale, required: false}, {prompt: "If someone opposes me, I can find the means and ways to get what I want.", labels: scale, required: false}, {prompt: "It is easy for me to stick to my aims and accomplish my goals.", labels: scale, required: false}],
        show_clickable_nav: true,
    }
    timeline.push(gse1);


    var gse2 = {
        type: 'survey-likert',
        questions: [{prompt: "I am confident that I can deal efficiently with unexpected events.", labels: scale, required: false}, {prompt: "Thanks to my resourcefullness, I know how to handle unforseen situations.", labels: scale, required: false}, {prompt: "I can solve most problems if I invest the necessary effort.", labels: scale, required: false}],
        show_clickable_nav: true,
    }
    timeline.push(gse2);



    var gse3 = {
        type: 'survey-likert',
        questions: [{prompt: "I can remain calm when facing difficulties because I can rely on my coping abilities.", labels: scale, required: false}, {prompt: "When I am confronted with a problem, I can usually find several solutions.", labels: scale, required: false}, {prompt: "If I am in trouble, I can usually think of a solution.", labels: scale, required: false}],
        show_clickable_nav: true,
    }
    timeline.push(gse3);

    var gse4 = {
        type: 'survey-likert',
        questions: [{prompt: "I can usually handle whatever comes my way.", labels: scale, required: false}, {prompt: "There is really no way I can solve some of the problems I have.", labels: scale, required: false}, {prompt: "Sometimes I feel that I am being pushed around in life.", labels: scale, required: false}],
        show_clickable_nav: true,
    }
    timeline.push(gse4);


    var gse5 = {
        type: 'survey-likert',
        questions: [{prompt: "I have little control over things that happen to me", labels: scale, required: false}, {prompt: "I can do just about anything I really set my mind to", labels: scale, required: false}, {prompt: "I often feel helpless in dealing with the problems of life.", labels: scale, required: false}],
        show_clickable_nav: true,
    }
    timeline.push(gse5);

    var scale = ["Strongly disagree", "Somewhat disagree", "Somewhat agree", "Strongly agree"];

    var gse6 = {
        type: 'survey-likert',
        questions: [{prompt: "What happens to me in the future mostly depends on me.", labels: scale, required: false}, {prompt: "If you are reading this attentively, answer that you somewhat agree with this point.", labels: scale, required: false}, {prompt: "There is little I can do to change many of the important things in my life.", labels: scale, required: false}],
        show_clickable_nav: true,
    }
    timeline.push(gse6);

    var instructions = {
      type: 'instructions',
      pages: ['Thank you for answering the questions! <br><br> The people who participate in this study are from diverse backgrounds, and because of that, we would like to know more about you and your background. This information will only be analyzed at an aggregate level and used to draw general conclusions about the socio-demographic composition of the sample.'],
      show_clickable_nav:true,
    }
    timeline.push(instructions);

    var instructions = {
      type: 'instructions',
      pages: ['The statements that you will see on the next screen relate to the ways different people think about their economic situation. Please read these statements carefully and evaluate to what extent you would agree or disagree with each of them.'],
      show_clickable_nav:true,
    }
    timeline.push(instructions);

    var scale = ["Strongly disagree", "Somewhat disagree", "Neither agree, nor disagree", "Somewhat agree", "Strongly agree"];

    var current_status = {
        type: 'survey-likert',
        questions: [{prompt: "I have enough money to buy things I want.", labels: scale, required: false}, {prompt: "I don't need to worry too much about paying my bills.", labels: scale, required: false}, {prompt: "I don't think I'll have to worry about money too much in the future.", labels: scale, required: false}],
        show_clickable_nav: true,
    }
    timeline.push(current_status);

    var scale = ["Strongly disagree", "Somewhat disagree", "Neither agree, nor disagree", "Somewhat agree", "Strongly agree"];

    var child_status = {
        type: 'survey-likert',
        questions: [{prompt: "My family usually had enough money for things when I was growing up.", labels: scale, required: false}, {prompt: "I grew up in a relatively wealthy neighbourhood.", labels: scale, required: false}, {prompt: "I felt relatively wealthy compared to the other kids in my school.", labels: scale, required: false}],
        show_clickable_nav: true,
    }
    timeline.push(child_status);


    var page_2_options = ["No, I have never solved Sudoku puzzles before", "Yes, I solved Sudoku once or twice", "Yes, I solve Sudoku occasionally", "Yes, I solve Sudoku regularly"];

    var sudoku_experience = {
        type: 'survey-multi-choice',
        questions: [{prompt: "Have you ever solved Sudoku puzzles before?", options: page_2_options, required: true}],
        show_clickable_nav: true,
    }
    timeline.push(sudoku_experience);



/*those who picked first two options (never solved sudoku and tried once or twice) should skip the next question; those who picked the 3rd and 4th options should answer the next question).*/

    var page_2_options = ["Very bad", "Rather bad", "Average", "Rather good", "Very good"];

    var sudoku_competence = {
        type: 'survey-multi-choice',
        questions: [{prompt: "How good are you at Sudoku?", options: page_2_options, required: false}],
        show_clickable_nav: true,
    }
        // timeline.push(sudoku_competence);

    var if_node = {
        timeline: [sudoku_competence],
        conditional_function: function(data){
          var data = jsPsych.data.get().last(1).values()[0];
          // console.log(JSON.parse(data.responses).Q0);
          if((JSON.parse(data.responses).Q0 == "No, I have never solved Sudoku puzzles before") || (JSON.parse(data.responses).Q0 == "Yes, I solved Sudoku once or twice")){
            return false;
          } else {
            return true;
          }
        }
     }
     timeline.push(if_node);



    var edu_options = ["Less than four years of high school", "High school (four years or more)", "Undergraduate degree (e.g., BA)", "Graduate degree (e.g., MA, MSc)"];

    var edu = {
        type: 'survey-multi-choice',
        questions: [{prompt: "What is your highest level of formal education?", options: edu_options, required: true}],
        show_clickable_nav: true,
    }
    timeline.push(edu);


    /*those who picked the last two options (undergrad and grad degrees should answer the next question (major1)) and skip (Student and Major2 questions. Those who picked the second option (high school) should skip major 1 questions and answer Student question. Those who picked the first option (less than four years of high school) should skip the next three questions (major1, student and major2) and get to the next instructions*/

    var major1 = {
      type: 'survey-text',
      questions: [{prompt: 'What was your main field of study?',
                  rows: 1, columns: 50}],
               show_clickable_nav: true,
    }
    // timeline.push(major1);

    var page_2_options = ["Yes, I am a university student now", "No, I am not a student"];

    var student = {
        type: 'survey-multi-choice',
        questions: [{prompt: "Are you a university student now?", options: page_2_options, required: false}],
        show_clickable_nav: true,
    }
    // timeline.push(student);

    var if_major1 = {
        timeline: [major1],
        conditional_function: function(data){
          var data = jsPsych.data.get().last(1).values()[0];
          // console.log(JSON.parse(data.responses).Q0);
          if((JSON.parse(data.responses).Q0 == "Undergraduate degree (e.g., BA)") || (JSON.parse(data.responses).Q0 == "Graduate degree (e.g., MA, MSc)")){
            return true;
          } else {
            return false;
          }
        }
     }
     timeline.push(if_major1);

    var if_student = {
        timeline: [student],
        conditional_function: function(data){
          var data = jsPsych.data.get().last(1).values()[0];
          // console.log(JSON.parse(data.responses).Q0);
          if((JSON.parse(data.responses).Q0 == "High school (four years or more)")){
            return true;
          } else {
            return false;
          }
        }
     }
     timeline.push(if_student);

     /* those who answer YES should answer the next question (major2), others go to the next Instructions */

    var major2 = {
      type: 'survey-text',
      questions: [{prompt: 'What is your main field of study?',
                  rows: 1, columns: 50}],
               show_clickable_nav: true,
    }
    // timeline.push(major2);

      var if_major2 = {
      timeline: [major2],
      conditional_function: function(data){
        var data = jsPsych.data.get().last(1).values()[0];
        // console.log(JSON.parse(data.responses).Q0);
        if((JSON.parse(data.responses).Q0 == "Yes, I am a university student now")){
          return true;
        } else {
          return false;
        }
      }
     }
     timeline.push(if_major2);

    

    var age_options = ["18 - 25 years of age", "26 - 35 years of age", "36 - 45 years of age", "46 - 60 years of age", "61 years of age and older"];

    var age = {
            type: 'survey-multi-choice',
            questions: [{prompt: "How old are you?", options: age_options, required: false}],
            show_clickable_nav: true,
        }
        timeline.push(age);

    var sex = {
      type: 'survey-text',
      questions: [{prompt: 'Please indicate your gender.',
                  rows: 1, columns: 50}],
               show_clickable_nav: true,
    }
    timeline.push(sex);

    var eth_options = ["Asian/ Pacific Islander", "Black or African American", "Hispanic or Latino", "Native American or American Indian", "White", "Other"];

    var ethnicity = {
          type: 'survey-multi-choice',
          questions: [{prompt: "Which of the following groups do you identify with most? <br> (These categories might not perfectly represent all ethnic groups, however, we use this standard classification in order to be able to compare the results of this study with previous studies.)", options: eth_options, required: false}],
          show_clickable_nav: true,
    }
    timeline.push(ethnicity);

    var instructions = {
      type: 'instructions',
      pages: [

      "Thank you for answering the questions! You will now proceed to the next stage of the study. <br><br> During this stage, you will solve eight letter Sudoku puzzles. You will have 120 seconds to try to complete each puzzle. At certain points, we will also ask you a few questions related to your experiences with the puzzles. <br><br> Have never solved a Sudoku puzzle before? That is not a problem; you do not need to have any prior experience or special knowledge. The next few screens will explain what Sudoku are and how to solve them.",

      "A Sudoku puzzle is a grid with several cells, that has been subdivided into several subgrids. <br> <br> <img src='img/1.png'></img> <br> <br> The goal of Sudoku is to enter letters in each cell, in such a way that: <br> <br> -  Each horizontal row (shown in red) contains each letter exactly once <br> - Each vertical column (shown in green) contains each letter exactly once <br> - Each subgrid or region (shown in blue) contains each letter exactly once <br> <br> In each Sudoku puzzle, several letters have already been entered (the 'givens'); these may not be changed. Your job is to fill the remainder of the grid with letters, respecting the three constraints mentioned earlier." ,


      "Let’s have a look at this puzzle and one possible way to go about the solution. <br> <img src='img/2.png'></img> <br>The most important thing to keep in mind is that each Line, Column and Region should contain each letter (A B C D E F) only once. <br><br> Please click NEXT to see the solution. ",

      "<img src='img/3.png'></img> <br><br> Step 1: <br><br> Look at Regions that already contain five letters out of six. These are Regions 1, 2 and 4. Fill the missing letters: F in Region 1 and E in Regions 2 and 4. ",

      "<img src='img/4.png'></img> <br><br> Step 2: <br><br> Look at the Columns and Lines that already contain five letters out of six. These are Columns 1, 5 and 6, and Line 6. Fill the missing letters: D in Column 1, E in Column 5 and Line 6, and A in Column 6. ",

      "<img src='img/5.png'></img> <br><br> Step 3: <br><br> Only three letters are missing now. Column 2 misses A and Line 5 misses D. When you fill them, you will see that the remaining letter in Column 4 is E. ",



      ],
      show_clickable_nav: true,
    }

    var save = {
      type: 'call-function',
      func: function(){
        save_data(jsPsych.data.getLastTimelineData().values());
      }
    }
    timeline.push(save);


    var ready = {
      type: 'html-keyboard-response',
      stimulus: 'Are you ready to solve a practice Sudoku? <br><br> Yes, I am ready! (Press C) <br><br> Not yet, I would like to read the rules once again, please! (Press R)',
      choices: ['r', 'c'],

    }

    /* Checks if the user entered R or C */

    var if_node = {
        timeline: [instructions, ready],
        loop_function: function(data){
          var data = jsPsych.data.get().last(1).values()[0];
          if(data.key_press == jsPsych.pluginAPI.convertKeyCharacterToKeyCode('c')){
            return false;
          } else {
            return true;
          }
        }
     }
     timeline.push(if_node);

     var instructions = {
      type: 'instructions',
      pages: [
      'Before you solve your first Sudoku puzzle, we would like to know how you estimate your chances to be successful at the puzzle solution.'
      ],
      show_clickable_nav: true,
    }
    timeline.push(instructions);

    var scale = ["1 (Certain that I WILL NOT solve it)", "2", "3", "4", "5 (Uncertain)", "6", "7", "8", "9 (Certain I WILL solve it)"];

    var appraisal1 = {
        type: 'survey-likert',
        questions: [{prompt: "Please indicate how certain you are that you will be able to solve the puzzle within 120 seconds timeframe (1 = I am completely certain I WILL NOT be able to solve the puzzle correctly; 5 = I am completely uncertain about the outcome; 9 = I am competely certain I WILL be able to solve the puzzle correctly.)", labels: scale, required: true}],
        show_clickable_nav: true,
    }
    timeline.push(appraisal1);


     var appraisal_instructions = {
      type: 'instructions',
      pages: [
      'You will now see several Sudoku puzzles, similar to the ones that you will solve. We would like to ask you to indicate for each puzzle, whether you feel that you can solve it or not. <br><br> Each puzzle will be presented on a new screen. You will need to give an answer by pressing one of the keyboard keys in the following format: <br><br> I am confident that I CAN solve the puzzle (Press D), <br> I am confident that I CANNOT solve the puzzle (Press K).',
      "Each puzzle will appear on a screen for a limited time, so it is very important that you give the response (press the relevant key) as quickly as possible. Please do not try to solve the puzzles; you will have a chance to do it very soon."
      ],
      show_clickable_nav: true,
    }
    timeline.push(appraisal_instructions);


    /********************** ADD 1ST ROUND APPRAISAL HERE*****************
    **********************************************************************/


    var appr_1 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app1.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_1);

    var appr_2 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app2.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_2);

    var appr_3 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app3.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_3);

    var appr_4 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app4.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_4);

    var appr_5 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app5.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_5);



     var pre_test = {
      type: 'instructions',
      pages: [
      "Thank you for your answers! Please take a moment to learn some technical tips that will help you solve the puzzles.",

      "Here are a few technical tips: <br> <br> To navigate through puzzle cells, you can use both the computer mouse and arrow keys. <br> If you make an error, the respective cell will be highlighted in red. To correct the error, please select the letter you would like to change and insert the correct one. <br> As soon as you complete the puzzle, you will be presented with the further instructions.",
      "We will very much appreciate if you stay focused and not get distracted while you are solving the puzzles. The results obtained in this study will be used to design a new psychological instrument. That is why it is crucial that they are as accurate as possible. <br> <br> We very much value your time and effort and appreciate your cooperation. <br> <br> Please click NEXT to start solving your first Sudoku."
      ],
      show_clickable_nav: true,
    }
    timeline.push(pre_test);


    /* Sudoku pre-test WITHOUT TIMER */

/*    var s0 = {
      type: 'sudoku_trial',
      trial_duration: 600000,
      board_size: 'boards2x3',
      board_set: 'd',
      timer: false,
    }
    timeline.push(s0);

    var post_test = {
      type: 'instructions',
      pages: [
      'The practice session is over. You are all set to start the actual test session! <br> <br> You will have 2 minutes to solve each puzzle. You can try to solve the puzzle for as long as you can until the time is up. Along with the puzzles, you will see the timer that will show how much time is left.',
      "We will very much appreciate if you stay focused and will not get distracted while you are solving the puzzles. The results obtained in this study will be used to design a new psychological instrument. That is why it is crucial that they are as accurate as possible. <br> <br> We very much value your time and effort and appreciate your cooperation. <br> <br> Please click NEXT to start solving the puzzles."
      ],
      show_clickable_nav: true,
    }
    timeline.push(post_test);*/



    /* ------------- SUDOKU TRIALS ------------------- */

     var s1 = {
      type: 'sudoku_trial',
      trial_duration: 1000,  
      board_size: 'boards2x3',
      board_set: 'a',
      board_nr: 1
     }
/*     var s2 = {
      type: 'sudoku_trial',
      trial_duration: 1000,  
      board_size: 'boards2x4',
      board_set: 'b'
     }
     var s3 = {
      type: 'sudoku_trial',
      trial_duration: 1000,  
      board_size: 'boards2x4',
      board_set: 'c'
     }*/

     var s_array = [s1 /*, s2, s3*/];

     var sudo_trials = jsPsych.randomization.shuffleNoRepeats(s_array);

     timeline.push.apply(timeline, sudo_trials);

     var instructions = {
       type: 'instructions',
       pages: [
       'You have completed your first trial. We would like to ask a couple of questions about your experiences.',
       "On the next screen, you will see a list of words that people use to describe how they feel. For each of these words, please indicate to what extent you felt this way while solving your last puzzle."
       ],
       show_clickable_nav: true,
     }
     timeline.push(instructions);

     var scale = ["1 (Did not feel this way at all during the task)", "2", "3", "4", "5 (Felt so to a moderate extent during the task)", "6", "7", "8", "9 (Felt so to a great extent during the task)"];

     var emotion1 = {
         type: 'survey-likert',
         questions: [{prompt: "Challenged                                        ", labels: scale, required: false}, {prompt: "Nervous                                        ", labels: scale, required: false}, {prompt: "Hopeful                                        ", labels: scale, required: false}],
         show_clickable_nav: true,
     }
     timeline.push(emotion1);

     var scale = ["1 (Did not feel this way at all during the task)", "2", "3", "4", "5 (Felt so to a moderate extent during the task)", "6", "7", "8", "9 (Felt so to a great extent during the task)"];

     var emotion1 = {
         type: 'survey-likert',
         questions: [{prompt: "Confident                                        ", labels: scale, required: false}, {prompt: "Sad                                        ", labels: scale, required: false}, {prompt: "Afraid                                        ", labels: scale, required: false}],
         show_clickable_nav: true,
     }
     timeline.push(emotion1);

      var scale = ["1 (Did not feel this way at all during the task)", "2", "3", "4", "5 (Felt so to a moderate extent during the task)", "6", "7", "8", "9 (Felt so to a great extent during the task)"];

     var emotion1 = {
         type: 'survey-likert',
         questions: [{prompt: "Interested                                        ", labels: scale, required: false}, {prompt: "Apathetic                                        ", labels: scale, required: false}, {prompt: "Bored                                        ", labels: scale, required: false}, {prompt: "Resigned                                        ", labels: scale, required: false}],
         show_clickable_nav: true,
     }
     timeline.push(emotion1);

       var instructions = {
         type: 'instructions',
         pages: [
         'Now we would like to ask you to reflect on your outcome. <br><br> The next screen will present the list of reasons that people generally use to explain their successes and failures at different tasks. For each of these reasons, please evaluate the extent with which it contributed to your outcome.'
         ],
         show_clickable_nav: true,
       }
       timeline.push(instructions);

       var scale = ["1 (Did not contribute at all)", "2", "3", "4", "5 (Contributed to a moderate extent)", "6", "7", "8", "9 (Contributed to a great extent)"];


     var attribution1 = {
        type: 'survey-likert',
        questions: [{prompt: "Time available to complete the task        ", labels: scale, required: false}, {prompt: "My capability to deal efficiently with novel tasks", labels: scale, required: false}, {prompt: "Luck                                              ", labels: scale, required: false}],
        show_clickable_nav: true,
     }
     timeline.push(attribution1);

     var attribution1_1 = {
         type: 'survey-likert',
         questions: [{prompt: "The amount of effort that I invested in the solution of the puzzle", labels: scale, required: false}, {prompt: "The experience that I had with similar tasks in the past", labels: scale, required: false}, {prompt: "My capability to solve similar tasks        ", labels: scale, required: false}],
         show_clickable_nav: true,
     }
     timeline.push(attribution1_1);

     var instructions = {
      type: 'instructions',
      pages: [
      'Before you solve the next few Sudoku puzzles, we would like to know how you estimate your chances to be successful at their solution.'
      ],
      show_clickable_nav: true,
    }
    timeline.push(instructions);

    var scale = ["1 (Certain that I WILL NOT solve it)", "2", "3", "4", "5 (Uncertain)", "6", "7", "8", "9 (Certain I WILL solve it)"];

    var appraisal2 = {
        type: 'survey-likert',
        questions: [{prompt: "Please indicate how certain you are that you will be able to solve the next puzzle within 120 seconds timeframe (1 = I am completely certain I WILL NOT be able to solve the puzzle correctly; 5 = I am completely uncertain about the outcome; 9 = I am competely certain I WILL be able to solve the puzzle correctly.)", labels: scale, required: false}],
        show_clickable_nav: true,
    }
    timeline.push(appraisal2);

    var instructions = {
     type: 'instructions',
     pages: [
     'You will now see several Sudoku puzzles, similar to the ones that you will solve. We would like to ask you to indicate for each puzzle, whether you feel that you can solve it or not. <br><br> Each puzzle will be presented on a new screen. You will need to give an answer by pressing one of the keyboard keys in the following format: <br><br> I am confident that I CAN solve the puzzle (Press D), <br> I am confident that I CANNOT solve the puzzle (Press K).',
     "Each puzzle will appear on a screen for a limited time, so it is very important that you give the response (press the relevant key) as quickly as possible. It is very important that you do not try to solve the puzzles."
     ],
     show_clickable_nav: true,
   }
   timeline.push(instructions);


    /********************** ADD 2ND ROUND APPRAISAL HERE*****************
    **********************************************************************/

    var appr_6 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app6.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_6);

    var appr_7 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app7.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_7);

    var appr_8 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app8.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_8);

    var appr_9 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app9.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_9);

    var appr_10 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app10.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_10);



    var instructions = {
       type: 'instructions',
       pages: [
       'Thank you for your answers! You will now solve the next six puzzles. You will have 120 seconds to attempt to solve each of them. <br><br> Each puzzle will be presented on a new screen. As soon as you are done with the puzzle solution, you will be automatically presented with the next one. <br><br> Good luck!'
       ],
       show_clickable_nav: true,
     }
     timeline.push(instructions);


     var s2 = {
      type: 'sudoku_trial',
      trial_duration: 1000,  
      board_size: 'boards2x3',
      board_set: 'a',
      board_nr: 3
     }
     var s3 = {
      type: 'sudoku_trial',
      trial_duration: 1000,  
      board_size: 'boards2x3',
      board_set: 'b',
      board_nr: 0
     }
     var s4 = {
      type: 'sudoku_trial',
      trial_duration: 1000,  
      board_size: 'boards2x3',
      board_set: 'b',
      board_nr: 2
     }
     var s5 = {
      type: 'sudoku_trial',
      trial_duration: 1000,  
      board_size: 'boards2x3',
      board_set: 'b',
      board_nr: 4
     }
     var s6 = {
      type: 'sudoku_trial',
      trial_duration: 1000,  
      board_size: 'boards2x3',
      board_set: 'c',
      board_nr: 1
     }
     var s7 = {
      type: 'sudoku_trial',
      trial_duration: 1000,  
      board_size: 'boards2x3',
      board_set: 'c',
      board_nr: 3
     }

     var s_array2 = [s2, s3, s4, s5, s6, s7];

     var sudo_trials2 = jsPsych.randomization.shuffleNoRepeats(s_array2);


     timeline.push.apply(timeline, sudo_trials2);

     var instructions = {
       type: 'instructions',
       pages: [
       'You have completed six more trials. Before you solve your final puzzle, we would like to once again ask a couple of questions about your experience with the last puzzle that you have just solved.',
       "On the next screen, you will see a list of words that people use to describe how they feel. For each of these words, please indicate to what extent you felt this way while solving the last puzzle."
       ],
       show_clickable_nav: true,
     }
     timeline.push(instructions);

     var scale = ["1 (Did not feel this way at all during the task)", "2", "3", "4", "5 (Felt so to a moderate extent during the task)", "6", "7", "8", "9 (Felt so to a great extent during the task)"]

     var emotion2 = {
         type: 'survey-likert',
         questions: [{prompt: "Challenged                                        ", labels: scale, required: false}, {prompt: "Nervous                                        ", labels: scale, required: false}, {prompt: "Hopeful                                        ", labels: scale, required: false}],
         show_clickable_nav: true,
     }
     timeline.push(emotion2);

     var emotion2 = {
         type: 'survey-likert',
         questions: [{prompt: "Confident                                        ", labels: scale, required: false}, {prompt: "Sad                                        ", labels: scale, required: false}, {prompt: "Afraid                                        ", labels: scale, required: false}],
         show_clickable_nav: true,
     }
     timeline.push(emotion2);

     var reason2 = {
       type: 'survey-likert',
       questions: [{prompt: "Interested                                        ", labels: scale, required: false}, {prompt: "Apathetic                                        ", labels: scale, required: false}, {prompt: "Bored                                        ", labels: scale, required: false}, {prompt: "Resigned                                        ", labels: scale, required: false}],
       show_clickable_nav: true,
     }
     timeline.push(reason2);

     var instructions = {
       type: 'instructions',
       pages: [
       'Now we would like to ask you to reflect on the outcome of the last puzzle. <br><br> The next screen will present the list of reasons that people generally use to explain their successes and failures at different tasks. For each of these reasons, please evaluate the extent with which it contributed to your outcome.'
       ],
       show_clickable_nav: true,
     }
    timeline.push(instructions); 

    var scale = ["1 (Did not contribute at all)", "2", "3", "4", "5 (Contributed to a moderate extent)", "6", "7", "8", "9 (Contributed to a great extent)"];


    var attribution2 = {
        type: 'survey-likert',
        questions: [{prompt: "Time available to complete the task        ", labels: scale, required: false}, {prompt: "My capability to deal efficiently with novel tasks", labels: scale, required: false}, {prompt: "Luck                                              ", labels: scale, required: false}],
        show_clickable_nav: true,
    }
    timeline.push(attribution1);

    var attribution2_2 = {
        type: 'survey-likert',
        questions: [{prompt: "The cause is something that is variable over time (1 = Strongly disagree, 5 = Neither disagree, nor agree, 9 = Strongly agree)", labels: scale, required: false}, {prompt: "The cause is something about you (1 = Strongly disagree, 5 = Neither disagree, nor agree, 9 = Strongly agree)", labels: scale, required: false}, {prompt: "The cause is something that is changeable (1 = Strongly disagree, 5 = Neither disagree, nor agree, 9 = Strongly agree)", labels: scale, required: false}, {prompt: "The cause is something for which no one is responsible (1 = Strongly disagree, 5 = Neither disagree, nor agree, 9 = Strongly agree)", labels: scale, required: false}],
        show_clickable_nav: true,
    }
    timeline.push(attribution1_1);

      var instructions = {
       type: 'instructions',
       pages: [
       'Before you solve the last Sudoku, we would like to ask you one last time to estimate your chances to be successful at the puzzle solution.'
       ],
       show_clickable_nav: true,
     }
     timeline.push(instructions);

     var scale = ["1 (Certain that I WILL NOT solve it)", "2", "3", "4", "5 (Uncertain)", "6", "7", "8", "9 (Certain I WILL solve it)"];

      var appraisal3 = {
          type: 'survey-likert',
          questions: [{prompt: "Please indicate how certain you are that you will be able to solve the next puzzle within 120 seconds timeframe (1 = I am completely certain I WILL NOT be able to solve the puzzle correctly; 5 = I am completely uncertain about the outcome; 9 = I am competely certain I WILL be able to solve the puzzle correctly.)", labels: scale, required: false}],
          show_clickable_nav: true,
      }
      timeline.push(appraisal2);

      var instructions = {
       type: 'instructions',
       pages: [
       'You will now see several Sudoku puzzles, similar to the one that you will solve. We would like to ask you to indicate for each puzzle, whether you feel that you can solve it or not. <br><br> Each puzzle will be presented on a new screen. You will need to give an answer by pressing one of the keyboard keys in the following format: <br><br> I am confident that I CAN solve the puzzle (Press D), <br> I am confident that I CANNOT solve the puzzle (Press K).',
       "Each puzzle will appear on a screen for a limited time, so it is very important that you give the response (press the relevant key) as quickly as possible. It is very important that you do not try to solve the puzzles."
       ],
       show_clickable_nav: true,
     }
     timeline.push(instructions);



    /********************** ADD 3RD ROUND APPRAISAL HERE*****************
    **********************************************************************/

    var appr_11 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app11.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_11);

    var appr_12 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app12.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_12);

    var appr_13 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app13.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_13);

    var appr_14 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app14.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_14);

    var appr_15 = {
      type: 'image-keyboard-response',
      stimulus: 'img/app15.png',
      choices: ['d','k'],
      trial_duration: 1000,
      prompt: '<p>Please indicate whether you can or cannot solve this task in <b>120</b> seconds <br> <br>Press <b>D</b> for <b>YES</b>, and <b>K</b> for <b>NO</b> </p>'
    }
    timeline.push(appr_15);

      var instructions = {
       type: 'instructions',
       pages: [
       'Congratulations! You have completed all activities of this study.'
       ],
       show_clickable_nav: true,
     }
     timeline.push(instructions);

      var debrief = {
       type: 'instructions',
       pages: [
       'Dear Participant, <br> You have just participated in a study that aims to develop a new psychological instrument. However, this study also has other objective. We did not reveal to you the information about this objective in advance, because this may have affected the way you responded. <br><br> In addition to the development of a new instrument, we aim to test how people with different socioeconomic backgrounds appraise their ability to successfully perform at a novel task and how they react to the situations of success and failure. Because early-life economic disadvantage is associated with the lack of mastery experiences needed to build up the sense of confidence, we suggested that people who were disadvantaged in childhood would estimate their chances to succeed as lower, experience more negative emotions while solving the puzzles, and attribute their success to external and unstable factors (e.g., luck, the amount of time available to solve the puzzle).',
       'To test this idea, we asked people with high and low economic status in childhood to fill out the psychological scales that measure confidence, appraise their ability to successfully perform at Sudoku puzzles, and solve several puzzles, either allowing sufficient time for puzzles solution or not. Please note that the amount of time available for the solution of some puzzles was too little to allow their successful solution.',
       'All information collected during the study period will be kept strictly confidential. No publications or reports from this project will include identifying information on any participant. The data will be analyzed and presented at an aggregate level. There will be no record that links the data collected from you with any personal data from which you could be identified. Once anonymized, these data may be made available to researchers via accessible data repositories and possibly used for novel purposes.',
       'Please contact Olga Poluektova, Ph.D. Fellow at Bremen Graduate School of Social Sciences (BIGSSS) at opoluektova@bigsss-bremen.de, if you would like to receive additional information or ask any questions about the study, or BIGSSS Ethics Committee at ethics@bigsss-bremen.de in case you have any concerns regarding your participation.'
       ],
       show_clickable_nav: true,
     }
     timeline.push(debrief);


    var email = {
        type: 'survey-text',
        questions: [{prompt: 'If you would like to receive the summary of the main findings, you can type in your e-mail address in the box below. We will happily share the summary with you as soon as the study is completed and the data are analyzed.',
                    rows: 1, columns: 50}],
                 show_clickable_nav: true,
      }
      timeline.push(email);

    var save = {
      type: 'call-function',
      func: function(){
        save_data(jsPsych.data.get().values());
      }
    }
    timeline.push(save);

    var end = {
     type: 'instructions',
     pages: [
     'We thank you for your participation and will be happy to answer any questions or provide additional comments about the study.'
     ],
     show_clickable_nav: true,
   }
   timeline.push(end);


     timeline.push({
      type: 'html-keyboard-response',
      stimulus: 'Press any key to quit.'
    });

            /**************************************
            *            END OF TRIAL
            ***************************************/

    function save_data(data){
       var xhr = new XMLHttpRequest();
         xhr.open('POST', 'write_data.php');
         xhr.setRequestHeader('Content-Type', 'application/json');
         xhr.onload = function() {
           if(xhr.status == 200){
             var response = JSON.parse(xhr.responseText);
             console.log(response);
           }
         };
         xhr.send(JSON.stringify(data));
       }

    
    jsPsych.init({
      timeline: timeline,
      on_finish: function() {
        // var alldata = jsPsych.data.get();
        // save_data(alldata);
         // console.log(jsPsych.data.get().uniqueNames());
         // jsPsych.data.displayData();
      }
      // on_finish: function(){ jsPsych.data.displayData(); },
      //   default_iti: 250
    })


  </script>
  </body>

</html>
